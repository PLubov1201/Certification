IMDb Movies Analysis

Постановка задачи

В связи с санкциями отечественное кинопроизводство укрепилось в своих позициях. Съемочной группе необходимо понять, какие жанры нравятся людям и какая длительность фильмов приемлема. Для этого требуется проанализировать предоставленный датасет с IMDb и выполнить следующие задачи:

1.	Вывести все фильмы с участием Тома Круза, отсортированные сначала по убыванию, затем по возрастанию рейтинга IMDb, при условии, что длительность фильма больше 100 минут, и перевести длительность фильма в часы.
2.	Создать витрину, которая будет отражать все лучшие комедии до 2000 года.
3.	Составить витрину худших фильмов в жанре драма за все года.
4.	Составить график самых топовых жанров (большое количество фильмов с высокой оценкой) за последние 50 лет.
5.	Вывести топ 5 режиссеров за последние 20 лет, чьи фильмы обладают самыми высокими оценками, указав среднее время их фильмов.
   
Технологии

Для выполнения задачи использовались следующие технологии и инструменты:
•	PySpark: для обработки больших объемов данных и выполнения сложных запросов.
•	Pandas: для преобразования данных из формата Spark DataFrame в формат Pandas DataFrame для построения графиков.
•	Matplotlib: для построения графиков и визуализации данных.
•	Parquet: для сохранения результирующих данных в эффективном и сжатом формате.

Установка и запуск

1.	Убедитесь, что у вас установлен Python и необходимые библиотеки. Вы можете установить их с помощью pip:
pip install pyspark pandas matplotlib
2.	Скачайте датасет с предоставленной ссылки и сохраните его в локальной директории.
3.	Сохраните приведенный ниже код в файл imdb_analysis.py.
4.	Запустите скрипт:
python imdb_analysis.py

Описание работы

1.	Загрузка данных и предварительная обработка:
   
o	Используем PySpark для создания сессии и загрузки данных из CSV файла.
o	Удаляем лишние пробелы в названиях столбцов.
o	Преобразуем длительность фильмов из строкового формата "130min" в целочисленный формат (в минутах) с использованием пользовательской функции (UDF).

2.	Анализ и создание витрин данных:
o	Фильмы с участием Тома Круза: фильтруем фильмы по актеру Том Круз, оставляем только фильмы с длительностью более 100 минут и сортируем по рейтингу IMDb.

o	Лучшие комедии до 2000 года: фильтруем фильмы по жанру "Comedy" и году выпуска до 2000, сортируем по рейтингу IMDb.

o	Худшие фильмы в жанре драма: фильтруем фильмы по жанру "Drama" и сортируем по рейтингу IMDb.

o	График топовых жанров: фильтруем фильмы за последние 50 лет, группируем по жанру и вычисляем средний рейтинг, строим график с использованием Matplotlib.

o	Топ 5 режиссеров за последние 20 лет: фильтруем фильмы за последние 20 лет, группируем по режиссеру, вычисляем средний рейтинг и среднюю длительность фильмов, выбираем топ 5 режиссеров по рейтингу.

4.	Сохранение результатов:
   
o	Сохраняем витрины данных в формате Parquet для эффективного хранения и последующего анализа.

Результаты

В результате выполнения скрипта будут созданы следующие витрины данных в формате Parquet:

1.	best_to_worst_tom_cruise_movies.parquet
2.	worst_to_best_tom_cruise_movies.parquet
3.	best_comedies_pre_2000.parquet
4.	worst_dramas.parquet
5.	top_genres_last_50_years.parquet
6.	top_5_directors_last_20_years.parquet
   
А также будет сохранен график топовых жанров за последние 50 лет в файле top_genres_last_50_years.png.

Эти витрины данных помогут анализировать предпочтения зрителей и планировать дальнейшие съемки фильмов в наиболее популярных жанрах.
